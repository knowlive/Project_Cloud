[실습3] 가용존과 vps 사용 (가용존이란 다른 하나가 망했을 때 다른하나로 바로 연결해서 살아남게 돕는 것)

*VPC 만들기

1. 서비스에서 vpc입력해서 들어감.
2. 메뉴 VPCs 에서 create VPC.
3. 이름 쓰고 CIDR block에서 10.20.0.0/20 범위 써주기
4. VPC생성후에 바로 아래 메뉴의 서브넷 생성
5. 해당 가용영역을 선택한 후, CIDR 블록을 2개로 나눠서 2개 생성. (10.20.1.0/24 , 10.20.2.0/24)

* 새 인스턴스 만들기 (vpc안의 인스턴스)

1. 네트워크 만들어진 VPC로 맞춤(서브넷도 마찬가지)
2. 퍼블릭 ip 활성화
(이거 cmd 창에서 ping 퍼블릭 ip해보면 네트워크 연결안됌. 
why? 게이트웨이가 없어서 내부적으로만 할당되었을 뿐, 바깥에서 들어오는 문이 없음.)
3. 인터넷 게이트웨이 메뉴로 들어옴, VPC에 할당될 게이트웨이 생성. 작업클릭해서 VPC연결.
(그래도 안돼. 라우팅 테이블 메뉴 들어가서 보기)
4. 라우팅 테이블 메뉴에서 아래의 라우팅 테이블에 라우팅 추가하기.
5. 편집눌러서 0.0.0.0/0 대상 주소로 추가하기(지정외의 나머지 것들을 바깥으로 나간다는 것 추가하는 것)
(이래도 PING 안되면 보안그룹 확인,  ICMP4(IPV4)확인 -> 에코 응답이 아니라 에코 요청임.)
6. 인스턴스 칸에서 밑에 메뉴칸 중, 인스턴스에 할당된 프라이빗ip확인하기.

+아예 인스턴스부터 제작할 때 미리 이 모든 것을 다 하고 생성해도 됨.

NAT : 기본 가상머신 아래에 하위의 새로운 네트워크를 만드는 것
브릿지 : 가상 머신 없이 다이렉트로 같은 대역대의 네트워크 이어서 만든다. (공용 프린트)

*인터넷 상에 되는 지 확인

1.ip를 웹에 쳐보기 전에 80번 433번 포트(http, https)열어주기
2.ip 쳐보면 웹이 제대로 떠야함.


*로드 밸런싱 

1. 대상그룹 새로 만들기 tomcat-ELB 80번포트로 vpc연결
2. 하위 메뉴에 대상 편집 -> 올라온 인스턴스 2개씩 모아서 그룹만들어주기
3. 로드밸런서 생성 -> 리스너 https 추가
